package speech

/** –ù–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ: –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª–∞–º–∏ –ø—Ä–∏–º–µ–Ω—è–µ–º—ã–º–∏ –∫ –ª–µ–∫—Å–µ–º–∞–º */
sealed class Semnorm(vararg val rules: (String) -> Boolean)

/** –ü—Ä–∞–≤–∏–ª–æ –Ω–µ—Å—Ç—Ä–æ–≥–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è (—Å—Ç–µ–º) */
private fun stem(vararg stems: String) = { word: String ->
  stems.any(word::startsWith)
}

/** –ü—Ä–∞–≤–∏–ª–æ —Å—Ç—Ä–æ–≥–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è (—Å–ª–æ–≤–æ) */
private fun word(vararg words: String) = { word: String ->
  words.any(word::equals)
}

/** –û–±—â–∏–π —Ç–∏–ø –¥–ª—è —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π –≤—Ä–µ–º–µ–Ω–∏ */
sealed class Time(vararg rules: (String) -> Boolean) : Semnorm(*rules)

object Year : Time(stem("y", "–≥", "–ª"))

object Month : Time(stem("mon", "–º–µ—Å"))

object Week : Time(stem("week", "–Ω–µ–¥–µ–ª"))

object Day : Time(stem("d", "–¥", "—Å—É—Ç–æ–∫", "—Å—É—Ç–∫"))

object Hour : Time(word("h", "—á"), stem("—á–∞—Å", "hour"))

object Minute : Time(stem("m", "–º"))

object Second : Time(stem("sec", "—Å–µ–∫"), word("s", "—Å"))

/** –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –±–∞–ª–∞–Ω—Å–∞ */
object Status : Semnorm(
  stem(
    "time",
    "–≤—Ä–µ–º",
    "balance",
    "status",
    "score",
    "coins",
    "–±–∞–ª–∞–Ω—Å",
    "—Å—Ç–∞—Ç—É—Å",
    "—Å—á–µ—Ç",
    "—Å—á—ë—Ç",
    "—É–∑–Ω–∞",
    "!",
    "timecoin",
    "check"
  )
)

/** –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞ –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤ */
object Transfer : Semnorm(
  stem(
    "transfer",
    "give",
    "take",
    "get",
    "keep",
    "–¥–µ—Ä–∂–∏",
    "–±–µ—Ä–∏",
    "–≤–æ–∑—å–º–∏",
    "—Ç—Ä–∞–Ω—Å—Ñ–µ—Ä",
    "–ø–µ—Ä–µ–≤–æ–¥",
    "–¥–∞—Ä",
    "–ø–æ–¥–∞—Ä",
    "–≤–∑—è–ª",
    "–∑–∞–±–µ—Ä",
    "–∑–∞–±–∏—Ä",
    "–ø–µ—Ä–µ–≤–µ–¥",
    "–ø–µ—Ä–µ–≤–µ—Å—Ç",
    "+"
  )
)

/** –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –±–∞–Ω–∞ */
object Ban : Semnorm(
  stem(
    "ban",
    "block",
    "freez",
    "mute",
    "–±–∞–Ω",
    "–±–ª–æ–∫",
    "–∑–∞–±–∞–Ω",
    "–∑–∞–≥–ª–æ—Ö",
    "—É–º—Ä–∏",
    "—É–º–µ—Ä",
    "üí•"
  )
)

/** –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –≤—ã–∫—É–ø–∞ */
object Redeem : Semnorm(
  stem(
    "redeem",
    "unblock",
    "unban",
    "unmute",
    "—Ä–∞–∑–±–∞–Ω",
    "—Ä–∞–∑–±–ª–æ–∫",
    "–æ–∂–∏–≤",
    "–≤—ã–∫—É–ø",
    "–¥–æ–Ω–∞—Ç"
  )
)

/** –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ—Å—å–±—ã –æ –ø–æ–º–æ—â–∏ */
object Help : Semnorm(
  stem(
    "–ø–æ–º–æ—â",
    "—Å–ø—Ä–∞–≤–∫",
    "–ø–æ–¥–¥–µ—Ä–∂–∫",
    "–∞–¥–º–∏–Ω",
    "–º–æ–¥–µ—Ä",
    "–ø—Ä–∞–≤–∏–ª",
    "–ø–æ–º–æ–≥",
    "?",
    "help",
    "rule",
    "faq",
    "admin",
    "moder",
    "support",
    "start",
    "—Å—Ç–∞—Ä—Ç"
  )
)

/** –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –æ–±—Ä–∞—â–µ–Ω–∏–π –∫ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É */
object Debug : Semnorm(
  stem(
    "—Ä–∞–∑—Ä–∞–±",
    "dev",
    "—Å–æ–∑–¥–∞—Ç–µ–ª—å",
    "creator",
    "bot",
    "–ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç",
    "programmer",
    "–±–æ—Ç",
    "–∞–≤—Ç–æ—Ä",
    "author"
  )
)

/** –ü—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–µ—Ñ–∏–∫—Å–∞ telegram-–∫–æ–º–∞–Ω–¥ */
object Skip : Semnorm(stem("/"))

/** –°–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ —á–∏—Å–µ–ª */
object Number : Semnorm(stem("0", "1", "2", "3", "4", "5", "6", "7", "8", "9"))

/** –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–µ–º—ã—Ö —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–∏—Ö –Ω–æ—Ä–º */
private val semnorms = listOf(

  Skip,

  Number,

  Year,
  Month,
  Week,
  Day,
  Hour,
  Minute,
  Second,

  Status,
  Transfer,
  Ban,
  Redeem,
  Help,
  Debug
)

/**
 * –ü—Ä–æ–≤–µ—Ä–∫–∞, —Å–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ —Å–ª–æ–≤–æ —Å —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–π –Ω–æ—Ä–º–æ–π?
 * –í–Ω–∏–º–∞–Ω–∏–µ! –£—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä
 * @return true –µ—Å–ª–∏ —Å–æ–≤–ø–∞–¥–∞–µ—Ç –∏ false –µ—Å–ª–∏ –Ω–µ—Ç
 */
private fun String.matches(norm: Semnorm) = norm.rules.any { it(this) }

/**
 * –ü–µ—Ä–µ–≤–æ–¥–∏–º –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—É—é –ª–µ–∫—Å–µ–º—É –Ω–∞–ø—Ä. `–∑–∞–±–∞–Ω–∏—Ç—å` –≤ –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ.
 * –†–µ–≥–∏—Å—Ç—Ä –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è.
 */
val String.semnorm get() = semnorms.firstOrNull(toLowerCase()::matches)